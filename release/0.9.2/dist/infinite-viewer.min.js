/*
Copyright (c) 2019 Daybrush
name: infinite-viewer
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/infinite-viewer.git
version: 0.9.2
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).InfiniteViewer=e()}(this,function(){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var s=function(){return(s=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function a(t){return void 0===t}var t=function(){var t=function(){function t(){this._eventHandler={},this.options={}}var e=t.prototype;return e.trigger=function(t,e){void 0===e&&(e={});var n=this._eventHandler[t]||[];if(!(0<n.length))return!0;n=n.concat(),e.eventType=t;var i=!1,r=[e],o=0;e.stop=function(){i=!0},e.currentTarget=this;for(var s=arguments.length,a=new Array(2<s?s-2:0),l=2;l<s;l++)a[l-2]=arguments[l];for(1<=a.length&&(r=r.concat(a)),o=0;n[o];o++)n[o].apply(this,r);return!i},e.once=function(r,o){if("object"==typeof r&&a(o)){var t,e=r;for(t in e)this.once(t,e[t]);return this}var s;return"string"==typeof r&&"function"==typeof o&&(s=this).on(r,function t(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];o.apply(s,n),s.off(r,t)}),this},e.hasOn=function(t){return!!this._eventHandler[t]},e.on=function(t,e){if("object"==typeof t&&a(e)){var n,i=t;for(n in i)this.on(n,i[n]);return this}var r;return"string"==typeof t&&"function"==typeof e&&(a(r=this._eventHandler[t])&&(this._eventHandler[t]=[],r=this._eventHandler[t]),r.push(e)),this},e.off=function(t,e){if(a(t))return this._eventHandler={},this;if(a(e)){if("string"==typeof t)return this._eventHandler[t]=void 0,this;var n,i=t;for(n in i)this.off(n,i[n]);return this}var r=this._eventHandler[t];if(r)for(var o,s=0;void 0!==(o=r[s]);s++)if(o===e){r=r.splice(s,1);break}return this},t}();return t.VERSION="2.1.2",t}(),h=['"',"'",'\\"',"\\'"];function u(t,e,n,i){for(var r=n;r<i;++r){var o=e[r].trim();if(o===t)return r;var s=r;if("("===o?s=u(")",e,r+1,i):-1<h.indexOf(o)&&(s=u(o,e,r+1,i)),-1===s)break;r=s}return-1}function l(t){return function(t,e){for(var n=new RegExp("(\\s*"+(e||",")+"\\s*|\\(|\\)|\"|'|\\\\\"|\\\\'|\\s+)","g"),i=t.split(n).filter(Boolean),r=i.length,o=[],s=[],a=0;a<r;++a){var l=i[a].trim(),c=a;if("("===l)c=u(")",i,a+1,r);else{if(")"===l)throw new Error("invalid format");if(-1<h.indexOf(l))c=u(l,i,a+1,r);else if(l===e){s.length&&(o.push(s.join("")),s=[]);continue}}-1===c&&(c=r-1),s.push(i.slice(a,c+1).join("")),a=c}return s.length&&o.push(s.join("")),o}(t,",")}function b(){return Date.now?Date.now():(new Date).getTime()}function c(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function S(t,e,n,i){t.addEventListener(e,n,i)}function E(t,e,n){t.removeEventListener(e,n)}var g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var y=function(){return(y=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function n(t){return 180*(e=[t[0].clientX,t[0].clientY],n=[t[1].clientX,t[1].clientY],i=n[0]-e[0],r=n[1]-e[1],(0<=(o=Math.atan2(r,i))?o:o+2*Math.PI)/Math.PI);var e,n,i,r,o}function C(t){return t.touches?function(t){for(var e=Math.min(t.length,2),n=[],i=0;i<e;++i)n.push(f(t[i]));return n}(t.touches):[f(t)]}function r(t,e,n){var i=n.length,r=d(t,i),o=r.clientX,s=r.clientY,a=r.originalClientX,l=r.originalClientY,c=d(e,i),h=c.clientX,u=c.clientY,g=d(n,i);return{clientX:a,clientY:l,deltaX:o-h,deltaY:s-u,distX:o-g.clientX,distY:s-g.clientY}}function p(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function f(t){return{clientX:t.clientX,clientY:t.clientY}}function d(t,e){void 0===e&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},i=0;i<e;++i){var r=t[i];n.originalClientX+="originalClientX"in r?r.originalClientX:r.clientX,n.originalClientY+="originalClientY"in r?r.originalClientY:r.clientY,n.clientX+=r.clientX,n.clientY+=r.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var z=function(){function t(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}var e=t.prototype;return e.addClients=function(t){void 0===t&&(t=this.prevClients);var e=this.getPosition(t),n=e.deltaX,i=e.deltaY;return this.movement+=Math.sqrt(n*n+i*i),this.prevClients=t,e},e.getAngle=function(t){return void 0===t&&(t=this.prevClients),n(t)},e.getRotation=function(t){return void 0===t&&(t=this.prevClients),n(t)-n(this.startClients)},e.getPosition=function(t){return r(t||this.prevClients,this.prevClients,this.startClients)},e.getPositions=function(n){void 0===n&&(n=this.prevClients);var i=this.prevClients;return this.startClients.map(function(t,e){return r([n[e]],[i[e]],[t])})},e.getMovement=function(t){var e=this.movement;if(!t)return e;var n=d(t,this.length),i=d(this.prevClients,this.length),r=n.clientX-i.clientX,o=n.clientY-i.clientY;return Math.sqrt(r*r+o*o)+e},e.getDistance=function(t){return void 0===t&&(t=this.prevClients),p(t)},e.getScale=function(t){return void 0===t&&(t=this.prevClients),p(t)/p(this.startClients)},e.move=function(e,n){this.startClients.forEach(function(t){t.clientX-=e,t.clientY-=n}),this.prevClients.forEach(function(t){t.clientX-=e,t.clientY-=n})},t}(),D=["textarea","input"],v=function(a){function t(){this.constructor=e}var e,n;function i(t,e){void 0===e&&(e={});var w=a.call(this)||this;w.options={},w.flag=!1,w.pinchFlag=!1,w.datas={},w.isDrag=!1,w.isPinch=!1,w.isMouse=!1,w.isTouch=!1,w.clientStores=[],w.targets=[],w.prevTime=0,w.isDouble=!1,w.onDragStart=function(t,e){if(void 0===e&&(e=!0),w.flag||!1!==t.cancelable){var n=w.options,i=n.container,r=n.pinchOutside,o=n.preventRightClick,s=n.preventDefault,a=n.checkInput,l=w.isTouch,c=!w.flag;if(c){var h,u=document.activeElement,g=t.target,p=g.tagName.toLowerCase(),f=-1<D.indexOf(p),d=g.isContentEditable;if(f||d){if(a||u===g)return!1;if(u&&d&&u.isContentEditable&&u.contains(g))return!1}else{(s||"touchstart"===t.type)&&u&&(h=u.tagName,(u.isContentEditable||-1<D.indexOf(h))&&u.blur())}if(w.clientStores=[new z(C(t))],w.flag=!0,w.isDrag=!1,w.datas={},o&&(3===t.which||2===t.button))return w.initDrag(),!1;!1===w.trigger("dragStart",y({datas:w.datas,inputEvent:t,isTrusted:e},w.getCurrentStore().getPosition()))&&w.initDrag(),w.isDouble=b()-w.prevTime<200,w.flag&&s&&t.preventDefault()}if(!w.flag)return!1;var v,m=0;if(c&&l&&r&&(m=setTimeout(function(){S(i,"touchstart",w.onDragStart,{passive:!1})})),!c&&l&&r&&E(i,"touchstart",w.onDragStart),w.flag&&((v=t).touches&&2<=v.touches.length)){if(clearTimeout(m),c&&t.touches.length!==t.changedTouches.length)return;w.pinchFlag||w.onPinchStart(t)}}},w.onDrag=function(t,e){var n,i;w.flag&&(n=C(t),i=w.moveClients(n,t,!1),(w.pinchFlag||i.deltaX||i.deltaY)&&w.trigger("drag",y({},i,{isScroll:!!e,inputEvent:t})),w.pinchFlag&&w.onPinch(t,n),w.getCurrentStore().addClients(n))},w.onDragEnd=function(t){var e,n,i,r,o,s;w.flag&&(n=(e=w.options).pinchOutside,i=e.container,w.isTouch&&n&&E(i,"touchstart",w.onDragStart),w.flag=!1,r=w.getCurrentStore().getPosition(),o=b(),s=!w.isDrag&&w.isDouble,w.prevTime=w.isDrag||s?0:o,w.trigger("dragEnd",y({datas:w.datas,isDouble:s,isDrag:w.isDrag,inputEvent:t},r)),w.pinchFlag&&w.onPinchEnd(t),w.clientStores=[])};var n=[].concat(t);w.options=y({checkInput:!1,container:1<n.length?window:n[0],preventRightClick:!0,preventDefault:!0,pinchThreshold:0,events:["touch","mouse"]},e);var i,r=w.options,o=r.container,s=r.events;return w.isTouch=-1<s.indexOf("touch"),w.isMouse=-1<s.indexOf("mouse"),w.targets=n,w.isMouse&&(n.forEach(function(t){S(t,"mousedown",w.onDragStart)}),S(o,"mousemove",w.onDrag),S(o,"mouseup",w.onDragEnd),S(o,"contextmenu",w.onDragEnd)),w.isTouch&&(i={passive:!1},n.forEach(function(t){S(t,"touchstart",w.onDragStart,i)}),S(o,"touchmove",w.onDrag,i),S(o,"touchend",w.onDragEnd,i),S(o,"touchcancel",w.onDragEnd,i)),w}g(e=i,n=a),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t);var r=i.prototype;return r.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(t,e){return t+e.movement},0)},r.isDragging=function(){return this.isDrag},r.isFlag=function(){return this.flag},r.isPinchFlag=function(){return this.pinchFlag},r.isPinching=function(){return this.isPinch},r.scrollBy=function(t,e,n,i){void 0===i&&(i=!0),this.flag&&(this.clientStores[0].move(t,e),i&&this.onDrag(n,!0))},r.move=function(t,e){var i=t[0],r=t[1],n=this.getCurrentStore().prevClients;return this.moveClients(n.map(function(t){var e=t.clientX,n=t.clientY;return{clientX:e+i,clientY:n+r,originalClientX:e,originalClientY:n}}),e,!0)},r.triggerDragStart=function(t){this.onDragStart(t,!1)},r.unset=function(){var e=this,t=this.targets,n=this.options.container;this.off(),this.isMouse&&(t.forEach(function(t){E(t,"mousedown",e.onDragStart)}),E(n,"mousemove",this.onDrag),E(n,"mouseup",this.onDragEnd),E(n,"contextmenu",this.onDragEnd)),this.isTouch&&(t.forEach(function(t){E(t,"touchstart",e.onDragStart)}),E(n,"touchstart",this.onDragStart),E(n,"touchmove",this.onDrag),E(n,"touchend",this.onDragEnd),E(n,"touchcancel",this.onDragEnd))},r.onPinchStart=function(t){var e,n=this.options.pinchThreshold;this.isDrag&&this.getMovement()>n||(e=new z(C(t)),this.pinchFlag=!0,this.clientStores.splice(0,0,e),!1===this.trigger("pinchStart",y({datas:this.datas,angle:e.getAngle(),touches:this.getCurrentStore().getPositions()},e.getPosition(),{inputEvent:t}))&&(this.pinchFlag=!1))},r.onPinch=function(t,e){var n;!this.flag||!this.pinchFlag||e.length<2||(n=this.getCurrentStore(),this.isPinch=!0,this.trigger("pinch",y({datas:this.datas,movement:this.getMovement(e),angle:n.getAngle(e),rotation:n.getRotation(e),touches:n.getPositions(e),scale:n.getScale(e),distance:n.getDistance(e)},n.getPosition(e),{inputEvent:t})))},r.onPinchEnd=function(t){var e,n;this.pinchFlag&&(e=this.isPinch,this.isPinch=!1,this.pinchFlag=!1,n=this.getCurrentStore(),this.trigger("pinchEnd",y({datas:this.datas,isPinch:e,touches:n.getPositions()},n.getPosition(),{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1)},r.initDrag=function(){this.clientStores=[],this.pinchFlag=!1,this.flag=!1},r.getCurrentStore=function(){return this.clientStores[0]},r.moveClients=function(t,e,n){var i=this.getCurrentStore()[n?"addClients":"getPosition"](t);return this.isDrag=!0,y({datas:this.datas},i,{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},i}(t);var e=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0};function m(t,e,n,i){var r,o,s=document.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",t),n.nonce&&s.setAttribute("nonce",n.nonce),s.innerHTML=(r=t,o=e,n.original?o:o.replace(/([^};{\s}][^};{]*|^\s*){/gm,function(t,e){var n=e.trim();return(n?l(n):[""]).map(function(t){var e=t.trim();return 0===e.indexOf("@")?e:-1<e.indexOf(":global")?e.replace(/\:global/g,""):-1<e.indexOf(":host")?""+e.replace(/\:host/g,"."+r):e?"."+r+" "+e:"."+r}).join(", ")+" {"})),(i||document.head||document.body).appendChild(s),s}function w(t,e){for(var n=t.length,i=0;i<n;++i)if(e(t[i],i))return!0;return!1}function T(t,e){for(var n=t.length,i=0;i<n;++i)if(e(t[i],i))return t[i];return null}function x(t,e){try{return new RegExp(t,"g").exec(e)}catch(t){return null}}function Y(t){return t.replace(/_/g,".")}function X(t,r){var o=null,s="-1";return w(t,function(t){var e,n,i=x("("+t.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",r);return i&&!t.brand&&(o=t,s=i[3]||"-1",t.versionAlias?s=t.versionAlias:t.versionTest&&(e=t.versionTest.toLowerCase(),n=x("("+e+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",r),s=(n?n[3]:"")||s),s=Y(s),1)}),{preset:o,version:s}}function P(t,n){return T(t,function(t){var e=t.brand;return x(""+n.test,e.toLowerCase())})}var A=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],H=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",brand:!0}],M=[{test:"applewebkit",id:"webkit"}],O=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],L=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"mac os x",id:"mac"},{test:"android",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function j(t){var e=function(t){var e=t;if(void 0===e){if("undefined"==typeof navigator||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}(t),n=!!/mobi/g.exec(e),i={name:"unknown",version:"-1",majorVersion:-1,webview:!!X(O,e).preset,chromium:!!X(H,e).preset,webkit:!1},r={name:"unknown",version:"-1",majorVersion:-1},o=X(A,e),s=o.preset,a=o.version,l=X(L,e),c=l.preset,h=l.version;return i.webkit=!i.chromium&&!!X(M,e).preset,c&&(r.name=c.id,r.version=h,r.majorVersion=parseInt(h,10)),s&&(i.name=s.id,i.version=a,i.webview&&"ios"===r.name&&"safari"!==i.name&&(i.webview=!1)),i.majorVersion=parseInt(i.version,10),{browser:i,os:r,isMobile:n,isHints:!1}}var _,F,R,W,B,N,k,V,q,I,G,Z,K,U,$,J="safari"===(void 0===_&&function(){if("undefined"!=typeof navigator&&navigator&&navigator.userAgentData){var t=navigator.userAgentData,e=t.brands||t.uaList;return e&&e.length}}()?(B=navigator.userAgentData,N=(B.uaList||B.brands).slice(),k=B.mobile||!1,V=N[0],q={name:V.brand,version:V.version,majorVersion:-1,webkit:!1,webview:w(O,function(t){return P(N,t)}),chromium:w(H,function(t){return P(N,t)})},I={name:"unknown",version:"-1",majorVersion:-1},q.webkit=!q.chromium&&w(M,function(t){return P(N,t)}),F&&(R=F.platform.toLowerCase(),W=T(L,function(t){return new RegExp(""+t.test,"g").exec(R)}),I.name=W?W.id:R,I.version=F.platformVersion),w(A,function(t){var e=P(N,t);return e&&(q.name=t.id,q.version=F?F.uaFullVersion:e.version,1)}),"Linux armv8l"===navigator.platform?I.name="android":q.webkit&&(I.name=k?"ios":"mac"),"ios"===I.name&&q.webview&&(q.version="-1"),I.version=Y(I.version),q.version=Y(q.version),I.majorVersion=parseInt(I.version,10),q.majorVersion=parseInt(q.version,10),{browser:q,os:I,isMobile:k,isHints:!0}):j(_)).browser.name,Q="infinite-viewer-",tt=Q+"wrapper",et=Q+"scroll-area",nt=Q+"horizontal-scroll-bar",it=Q+"vertical-scroll-bar",rt=Q+"scroll-thumb",ot=($=Q,G="\n{\n    position: relative;\n    overscroll-behavior: none;\n}\n.wrapper {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    top: 0;\n    left: 0;\n    will-change: scroll-position;\n}\n.wrapper::-webkit-scrollbar {\n    display: none;\n}\n.scroll-area {\n    position:absolute;\n    top:0;\n    left:0;\n    transform-origin: 0 0;\n}\n.scroll-bar {\n    position:absolute;\n    width: 10px;\n    height: 10px;\n    box-sizing: border-box;\n    right: 0;\n    bottom: 0;\n    overflow: hidden;\n}\n.horizontal-scroll-bar {\n    width: 100%;\n    height: 14px;\n}\n.vertical-scroll-bar {\n    height: 100%;\n    width: 14px;\n}\n.scroll-thumb {\n    position:relative;\n    opacity: 0.7;\n    background: #333;\n    border-radius: 3px;\n    left: 0px;\n    top: 0px;\n    z-index: 10;\n    width: 6px;\n    height: 6px;\n    transition: all ease 0.2s;\n}\n.horizontal-scroll-bar .scroll-thumb {\n    margin: 4px 0px;\n    transition-property: margin, height, border-radius;\n}\n.vertical-scroll-bar .scroll-thumb {\n    margin: 0px 4px;\n    transition-property: margin, width, border-radius;\n}\n.horizontal-scroll-bar:hover .scroll-thumb {\n    height: 10px;\n    margin: 2px 0px;\n    border-radius: 5px;\n}\n.vertical-scroll-bar:hover .scroll-thumb {\n    width: 10px;\n    margin: 0px 2px;\n    border-radius: 5px;\n}\n".replace(/([^}{]*){/gm,function(t,e){return e.replace(/\.([^{,\s\d.]+)/g,"."+$+"$1")+"{"}),{className:K="rCS"+e(G).toString(36),inject:function(t,e){void 0===e&&(e={});var n,i=function(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(t),r=0===U;return(i||r)&&(n=m(K,G,e,i)),r&&(Z=n),i||++U,{destroy:function(){i?(t.removeChild(n),n=null):(0<U&&--U,0===U&&Z&&(Z.parentNode.removeChild(Z),Z=null))}}}}),st={margin:500,threshold:100,zoom:1,rangeX:[-1/(U=0),1/0],rangeY:[-1/0,1/0],wrapperElement:null,scrollAreaElement:null,horizontalScrollElement:null,verticalScrollElement:null,usePinch:!1,pinchThreshold:30,cspNonce:"",wheelScale:.01,displayHorizontalScroll:!0,displayVerticalScroll:!0,useForceWheel:!1},at=ot.className,lt=["margin","threshold","zoom","rangeX","rangeY","usePinch","pinchThreshold","wheelScale","displayVerticalScroll","displayHorizontalScroll","useForceWheel"],ct=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}(lt,["cspNonce","wrapperElement","scrollAreaElement","verticalScrollElement","horizontalScrollElement"]),ht={margin:Number,threshold:Number,zoom:Number,wrapperElement:Object,scrollAreaElement:Object,verticalScrollElement:Object,horizontalScrollElement:Object,rangeX:Array,rangeY:Array,pinchThreshold:Number,usePinch:Boolean,useForceWheel:Boolean,cspNonce:String,wheelScale:Number,displayHorizontalScroll:Boolean,displayVerticalScroll:Boolean};function ut(t,e){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return Math.abs(n/e)}function gt(t){return Math.abs(t)}function pt(t,e,n,i,r){return[r||isFinite(n[0])?n[0]:Math.min(-1,Math.floor(t/e))*e-i,r||isFinite(n[1])?n[1]:Math.max(1,Math.ceil(t/e))*e+i]}var ft=function(i){function t(t,e){var a=i.call(this)||this;a.type=t,a.barElement=e,a.isAppend=!1,a.pos=0,a.size=0,a.scrollSize=0,a.isHorizontal=!1,a.onWheel=function(t){var e=a.isHorizontal?t.deltaX:t.deltaY;e&&t.preventDefault(),a.trigger("scroll",{delta:e})};var n,l="horizontal"===t;return a.isHorizontal=l,e?a.thumbElement=e.querySelector("."+rt):(e=document.createElement("div"),n=document.createElement("div"),c(e,l?nt:it),c(e,"infinite-viewer-scroll-bar"),c(n,rt),e.insertBefore(n,null),a.barElement=e,a.thumbElement=n,a.isAppend=!0),a.gesto=new v(a.barElement,{container:window}).on("dragStart",function(s){var t=s.inputEvent.target,e=s.datas,n=a.thumbElement===t;n||setTimeout(function(){requestAnimationFrame(function(){var t,e,n=a.thumbElement.getBoundingClientRect(),i=n[l?"left":"top"],r=i+n[l?"width":"height"],o=s[l?"clientX":"clientY"];i<=o&&o<=r||(e=(t=a.size)*t/a.scrollSize,a.scrollBy(i<o?e:-e))})},100),e.isThumb=n,s.inputEvent.stopPropagation(),s.inputEvent.preventDefault()}).on("drag",function(t){t.datas.isThumb&&a.scrollBy(a.isHorizontal?t.deltaX:t.deltaY)}),S(a.barElement,"wheel",a.onWheel,{passive:!1}),a}o(t,i);var e=t.prototype;return e.scrollBy=function(t){var e=t/this.size;this.trigger("scroll",{delta:this.scrollSize*e})},e.render=function(t,e,n,i){this.pos=e,this.size=n,this.scrollSize=i;var r=t&&n<i?"block":"none",o=this.isHorizontal?["X","width"]:["Y","height"],s=o[0],a=o[1];this.barElement.style.cssText="display: "+r+";",this.thumbElement.style.cssText+=a+": "+n*n/i+"px;transform: translate"+s+"("+e/i*n+"px)"},e.destroy=function(){E(this.barElement,"wheel",this.onWheel),this.gesto.off(),this.off()},t}(t),dt=function(i){function t(t,e,n){void 0===n&&(n={});var c=i.call(this)||this;return c.containerElement=t,c.viewportElement=e,c.offsetX=0,c.offsetY=0,c.containerWidth=0,c.containerHeight=0,c.viewportWidth=0,c.viewportHeight=0,c.scrollLeft=0,c.scrollTop=0,c.timer=0,c.dragFlag=!1,c.tempScale=1,c.isLoop=!1,c.resize=function(){var t=c.containerElement,e=t.offsetWidth,n=t.offsetHeight,i=c.viewportElement,r=i.offsetWidth,o=i.offsetHeight;c.containerWidth=e,c.containerHeight=n,c.viewportWidth=r,c.viewportHeight=o},c.onScroll=function(){var t=c.wrapperElement,e=t.scrollLeft,n=t.scrollTop,i=c.zoom,r=void 0===i?st.zoom:i,o=e-c.scrollLeft,s=n-c.scrollTop,a=c.getScrollLeft(),l=c.getScrollTop();c.isLoop&&(c.isLoop=!1),c.scrollLeft=e,c.scrollTop=n,c.scrollTo(a+o/r,l+s/r)},c.onWheel=function(t){var e=c.options;if(t.ctrlKey){var n=-t.deltaY,i=Math.max(1+n*(e.wheelScale||.01),1e-6);c.trigger("pinch",{distance:n,scale:i,rotation:0,zoom:c.zoom*i,inputEvent:t})}else{if(!J&&!e.useForceWheel)return;var r=c.zoom,o=t.deltaX,s=t.deltaY;t.shiftKey&&!o&&(o=s,s=0),c.scrollBy(o/r,s/r)}t.preventDefault()},c.onGestureStart=function(t){c.tempScale=c.zoom,t.preventDefault()},c.onGestureChange=function(t){var e;t.preventDefault(),!c.gesto.isFlag()&&c.tempScale?(e=t.scale,c.trigger("pinch",{distance:0,scale:e,rotation:t.rotation,zoom:c.tempScale*e,inputEvent:t})):c.tempScale=0},c.options=s(s({},st),n),c.init(),c}o(t,i);var n,r,e=t.prototype;return e.getContainer=function(){return this.containerElement},e.getViewport=function(){return this.viewportElement},e.getWrapper=function(){return this.wrapperElement},e.destroy=function(){this.off(),this.gesto.unset(),this.verticalScrollbar.destroy(),this.horizontalScrollbar.destroy(),this.injectResult.destroy();var t=this.containerElement;E(window,"resize",this.resize),E(this.wrapperElement,"scroll",this.onScroll),E(t,"wheel",this.onWheel),E(t,"tgesturestart",this.onGestureStart),E(t,"gesturechange",this.onGestureChange),this.gesto=null,this.injectResult=null,this.containerElement=null,this.viewportElement=null,this.options=null},e.getScrollTop=function(t){return this.scrollTop/this.zoom+this.offsetY+(t?gt(this.getRangeY()[0]):0)},e.getScrollLeft=function(t){return this.scrollLeft/this.zoom+this.offsetX+(t?gt(this.getRangeX()[0]):0)},e.getScrollWidth=function(t){var e=this.getRangeX(t);return this.containerWidth+gt(e[0])+gt(e[1])},e.getScrollHeight=function(t){var e=this.getRangeY(t);return this.containerHeight+gt(e[0])+gt(e[1])},e.scrollCenter=function(){this.resize();var t=this.zoom,e=-(this.containerWidth/t-this.viewportWidth)/2,n=-(this.containerHeight/t-this.viewportHeight)/2;return this.scrollTo(e,n)},e.scrollBy=function(t,e){return this.scrollTo(this.getScrollLeft()+t,this.getScrollTop()+e)},e.scrollTo=function(t,e){var n,i,r=this,o=this,s=o.zoom,a=void 0===s?st.zoom:s,l=o.margin,c=void 0===l?st.margin:l,h=o.threshold,u=void 0===h?st.threshold:h,g=o.scrollLeft,p=o.scrollTop,f=this.getRangeX(!0,!0),d=f[0],v=f[1],m=this.getRangeY(!0,!0),w=m[0],b=m[1],S=g,E=p,y=this.getScrollAreaWidth(),C=this.getScrollAreaHeight(),z=t*a,D=e*a;z-u<=d?(S=n=Math.max(0,z-d),t=(d+n)/a):v<=z+u?(i=Math.max(0,v-z),S=y-i,t=(v-i)/a):S<u?S+=c:y-u<S&&(S-=c),D-u<=w?(E=n=Math.max(0,D-w),e=(w+n)/a):b<=D+u?(i=Math.max(0,b-D),E=C-i,e=(b-i)/a):E<u?E+=c:C-u<E&&(E-=c),S=Math.round(S),E=Math.round(E),this.scrollLeft=S,this.scrollTop=E,this.offsetX=t-S/a,this.offsetY=e-E/a,this.render();var T=this.getScrollLeft(),x=this.getScrollTop();return this.trigger("scroll",{scrollLeft:T,scrollTop:x}),g===S&&p===E||(this.isLoop=!0,this.move(S,E),requestAnimationFrame(function(){var t,e,n;r.isLoop&&(r.isLoop=!1,e=(t=r.wrapperElement).scrollLeft,n=t.scrollTop,r.scrollLeft=e,r.scrollTop=n,S===e&&E===n||(console.log("??"),r.scrollTo(T,x)))}),!1)},e.setZoom=function(t){var e=this.containerWidth,n=this.containerHeight,i=this.zoom,r=this.getScrollLeft(),o=this.getScrollTop();this.options.zoom=t;var s=r+e/i/2,a=o+n/i/2,l=this.getScrollLeft()+e/t/2,c=this.getScrollTop()+n/t/2;this.scrollBy(s-l,a-c),this.render()},e.getRangeX=function(t,e){var n=this.rangeX,i=void 0===n?st.rangeX:n,r=this.margin,o=void 0===r?st.margin:r,s=this.zoom,a=void 0===s?st.zoom:s,l=this.threshold,c=pt(this.getScrollLeft(),o,i,l,e);return t?[c[0]*a,Math.max(this.viewportWidth*a-this.containerWidth,c[1]*a)]:c},e.getRangeY=function(t,e){var n=this.rangeY,i=void 0===n?st.rangeY:n,r=this.margin,o=void 0===r?st.margin:r,s=this.zoom,a=void 0===s?st.zoom:s,l=this.threshold,c=pt(this.getScrollTop(),o,i,l,e);return t?[c[0]*a,Math.max(this.viewportHeight*a-this.containerHeight,c[1]*a)]:c},e.init=function(){var r=this,t=this.containerElement,n=this.options;c(t,at);var e=n.wrapperElement||t.querySelector("."+tt),i=n.scrollAreaElement||t.querySelector("."+et),o=n.horizontalScrollElement||t.querySelector("."+nt),s=n.verticalScrollElement||t.querySelector("."+it);e||(c(e=document.createElement("div"),tt),e.insertBefore(this.viewportElement,null),t.insertBefore(e,null)),this.wrapperElement=e,i||(c(i=document.createElement("div"),et),e.insertBefore(i,e.firstChild)),this.scrollAreaElement=i,this.horizontalScrollbar=new ft("horizontal",o),this.verticalScrollbar=new ft("vertical",s),this.horizontalScrollbar.on("scroll",function(t){r.scrollBy(t.delta/r.zoom,0)}),this.verticalScrollbar.on("scroll",function(t){r.scrollBy(0,t.delta/r.zoom)}),this.horizontalScrollbar.isAppend&&t.insertBefore(this.horizontalScrollbar.barElement,null),this.verticalScrollbar.isAppend&&t.insertBefore(this.verticalScrollbar.barElement,null),c(t,at),this.injectResult=ot.inject(t,{nonce:this.options.cspNonce}),this.gesto=new v(t,{container:document.body,events:["touch"]}).on("dragStart",function(t){var e=t.inputEvent,n=t.datas,i=t.stop;r.pauseAnimation(),(r.dragFlag=!1)!==r.trigger("dragStart",{inputEvent:e})?(e.preventDefault(),n.startEvent=e):i()}).on("drag",function(t){var e;!r.options.usePinch||t.isPinch?(r.trigger("drag",{inputEvent:t.inputEvent}),function(t){var e=t.deltaX,n=t.deltaY,i=t.datas,r=Date.now(),o=i.speed;if(!o)return i.speed=[0,0],i.time=r;var s=r-i.time;i.speed=[o[0]/2+e/s,o[1]/2+n/s]}(t),e=r.zoom,r.scrollBy(-t.deltaX/e,-t.deltaY/e)):!r.dragFlag&&t.movement>n.pinchThreshold&&(r.dragFlag=!0,r.trigger("abortPinch",{inputEvent:t.datas.startEvent||t.inputEvent}))}).on("dragEnd",function(t){r.trigger("dragEnd",{isDrag:t.isDrag,isDouble:t.isDouble,inputEvent:t.inputEvent}),r.startAnimation(t.datas.speed)}).on("pinchStart",function(t){var e=t.inputEvent,n=t.datas,i=t.stop;e.preventDefault(),r.pauseAnimation(),n.startZoom=r.zoom,!1===r.trigger("pinchstart",{inputEvent:e})&&i()}).on("pinch",function(t){r.trigger("pinch",{rotation:t.rotation,distance:t.distance,scale:t.scale,zoom:t.datas.startZoom*t.scale,inputEvent:t.inputEvent})}),S(e,"scroll",this.onScroll),S(window,"resize",this.resize),S(t,"wheel",this.onWheel,{passive:!1}),S(t,"gesturestart",this.onGestureStart,{passive:!1}),S(t,"gesturechange",this.onGestureChange,{passive:!1}),this.resize(),this.render(),this.scrollTo(0,0)},e.render=function(){var t=this.offsetX,e=this.offsetY,n=this.zoom,i=void 0===n?st.zoom:n,r=-t*i,o=-e*i;this.scrollAreaElement.style.cssText="width:calc(100% + "+this.getScrollAreaWidth()+"px);height:calc(100% + "+this.getScrollAreaHeight()+"px);",this.viewportElement.style.cssText+="transform-origin: 0 0;transform:translate("+r+"px, "+o+"px) scale("+i+");",this.renderScroll()},e.renderScroll=function(){var t=this.containerWidth,e=this.containerHeight,n=this.zoom,i=this.getScrollLeft(!0)*n,r=this.getScrollTop(!0)*n,o=this.getScrollWidth(!0),s=this.getScrollHeight(!0);this.horizontalScrollbar.render(this.displayHorizontalScroll,i,t,o),this.verticalScrollbar.render(this.displayVerticalScroll,r,e,s)},e.move=function(t,e){var n=this.wrapperElement;n.scrollLeft=t,n.scrollTop=e},e.startAnimation=function(t){var r,o,s,e,n,a,l,c,h=this;t&&(t[0]||t[1])&&(r=function(t){return 1-Math.pow(1-t,3)},o=ut(t,-6e-4),n=ut(e=t,-6e-4),s=[e[0]/2*n,e[1]/2*n],a=Date.now(),l=a,c=function(){var t=Date.now(),e=t-a;o<e&&(e=o);var n=r(e/o),i=r((l-a)/o);l=t,h.scrollBy(-s[0]*(n-i),-s[1]*(n-i)),o<=e||(h.timer=requestAnimationFrame(c))},this.timer=requestAnimationFrame(c))},e.pauseAnimation=function(){cancelAnimationFrame(this.timer)},e.getScrollAreaWidth=function(){var t=this.getRangeX(!0),e=t[0],n=t[1];return e||n?2*this.margin:0},e.getScrollAreaHeight=function(){var t=this.getRangeY(!0),e=t[0],n=t[1];return e||n?2*this.margin:0},function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;0<=a;a--)(r=t[a])&&(s=(o<3?r(s):3<o?r(e,n,s):r(e,n))||s);return 3<o&&s&&Object.defineProperty(e,n,s),s}([(n=lt,r=function(t,e){var n={enumerable:!0,configurable:!0,get:function(){return this.options[e]}},i=("set "+e).replace(/[\s-_]([a-z])/g,function(t,e){return e.toUpperCase()});t[i]?n.set=function(t){this[i](t)}:n.set=function(t){this.options[e]=t},Object.defineProperty(t,e,n)},function(t){var e=t.prototype;n.forEach(function(t){r(e,t)})})],t)}(t),vt={__proto__:null,default:dt,OPTIONS:ct,OPTION_TYPES:ht,PROPERTIES:lt,EVENTS:["scroll","abortPinch","dragStart","dragEnd","pinchStart","pinch"],METHODS:["getScrollLeft","getScrollTop","getScrollWidth","getScrollHeight","scrollTo","scrollBy","scrollCenter","getContainer","getViewport","getWrapper","setZoom","getRangeX","getRangeY"],CLASS_NAME:at};for(var mt in vt)dt[mt]=vt[mt];return dt});
//# sourceMappingURL=infinite-viewer.min.js.map
